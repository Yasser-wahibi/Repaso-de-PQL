CREATE OR REPLACE TRIGGER DEL_ACTOR BEFORE DELETE ON ACTOR FOR EACH ROW

DECLARE

CONTGUI NUMBER;
CONTMUS NUMBER;
CONTDIR NUMBER;


BEGIN
--CHEACKEAMOS QUE ESTA EN ALGUNA DE ESTA TABLAS
SELECT COUNT(*) INTO CONTGUI FROM GUIONISTA WHERE NOM_PER=:OLD.NOM_PER;
SELECT COUNT(*) INTO CONTMUS FROM MUSICO WHERE NOM_PER=:OLD.NOM_PER;
SELECT COUNT(*) INTO CONTDIR FROM DIRECTOR WHERE NOM_PER=:OLD.NOM_PER;

IF CONTGUI>0 OR CONTMUS>0 OR CONTDIR>0 THEN 
  

  if  CONTDIR>0 then 
raise_application_error(-20003,'YA EXISTE  EN LA TABL DIRECTOR');
    END IF;


   if  CONTMUS>0 then 
        raise_application_error(-20002,'YA EXISTE  EN LA TABL MUSICO');
    END IF;

    if  CONTGUI>0 then 
        raise_application_error(-20001,'YA EXISTE  EN LA TABLA GUIONISTA');
    END IF;
END IF;



    DELETE FROM PER_PEL WHERE NOM_PER=:OLD.NOM_PER;
    DELETE FROM PER_NUM WHERE NOM_PER=:OLD.NOM_PER;
    DELETE FROM PER_LIB WHERE NOM_PER=:OLD.NOM_PER;
    DELETE FROM PERSONA WHERE NOM_PER=:OLD.NOM_PER;
    DBMS_OUTPUT.PUT_LINE('SE HA BORRADO DE LA TABLA ACTOR Y PERSONA');

END;
/
